# Context Bundle: <Feature Title>

> Confidentiality: <Public / Internal / Confidential>  
> Repo: <repo-name>  
> Ticket: <TICKET-ID>  
> Branch: <branch-name>  
> Phase: Requirements
> Updated: 2025-12-21 16:59 (JST)
> Owner: <name>

---

## 0) Operating Rules (Must Follow)
1. **Single Source of Truth**
   - Requirements truth: `10_prd/requirements.md`
   - Domain language truth: `20_domain/glossary.md`
   - Contract truth: `30_contract/openapi.yaml` and `30_contract/asyncapi.yaml`
   - Design truth: `40_design/design.md` and `40_design/architecture.md`
   - Review truth (mapping): `90_review/traceability.md`
2. **REQ discipline**
   - 1 REQ = 1 Acceptance Criterion (strict).
   - No implementation details in requirements.
3. **Traceability discipline**
   - Every contract item MUST map to REQ via `x-requirements`.
   - Every design component MUST declare which REQs it implements.
4. **No guesswork**
   - If information is missing/ambiguous, ask targeted questions before producing final artifacts.
   - Do not invent domain terms; add to glossary first.
5. **Bundle size discipline**
   - This bundle is a **control plane**, not a full dump.
   - Use **excerpts** only. If a section grows too large, replace details with pointers.
   - Focus REQs: default max **10** (extend only with explicit reason).
6. **Output discipline**
   - Produce outputs exactly in the format specified in section 8.
   - If proposing changes, include a **diff-style summary** (Added/Changed/Removed).

---

## 1) Objective (What we are doing now)
- **Current objective**: ドメイン用語と概念モデルを確立し、glossary.md と domain.md を完成させる
- **Definition of Done**:
  - DoD-1: glossary.md に主要用語が Canonical term として定義されている
  - DoD-2: domain.md に Bounded Context、Entity、Aggregate が定義されている
  - DoD-3: ドメイン不変条件（Invariants）が明記されている
---

## 2) Executive Summary (Read-first)
- **One-liner**: 個人用のタスクマネジメントアプリケーションをTauri + Rust + SQLite + Reactで開発する
- **Why**: 既存TMSの改善版として新しい技術スタックでの実装を開始し、クロスプラットフォーム対応とパフォーマンス向上を目指すため
- **Scope**: タスクプール管理と日次タスクキュー作成の基本機能を含む。複数ユーザー対応、クラウド同期、外部サービス連携は除外
- **Top risks**: Tauri + Rustの学習コスト、技術スタックの互換性問題、パフォーマンス問題

---

## 3) Canonical Pointers (Authoritative file paths)
> "最新版"はこのパスに存在する前提（v2など別名ファイルを作らない）。

- PRD: `10_prd/PRD.md`
- Requirements: `10_prd/requirements.md`
- Domain: `20_domain/domain.md`
- Glossary: `20_domain/glossary.md`
- OpenAPI (HTTP): `30_contract/openapi.yaml`
- AsyncAPI (Events): `30_contract/asyncapi.yaml`
- Architecture: `40_design/architecture.md`
- Design: `40_design/design.md`
- Decisions (ADR): `40_design/decisions.md`
- Tasks: `40_design/tasks.md`
- Traceability: `90_review/traceability.md`

---

## 4) Non-negotiables (Constraints)
### 4.1 Product / Business
- 個人開発プロジェクトのため、納期・運用制約なし
- 単一ユーザー専用（今後拡張予定）

### 4.2 Technical
- Tauri + Rust + SQLite + Reactの技術スタックを使用
- ローカルアプリケーションとして実装（クラウド同期なし）
- Node.js 18+, Rust 1.70+ を前提とした開発環境

### 4.3 Security / Compliance
- 個人情報は含まれないため、セキュリティ要件は最小限
- データはローカルSQLiteに保存

---

## 5) Domain Snapshot (Ubiquitous Language)
> 重要語のみ抜粋。用語追加が必要なら先にglossaryへ。

### 5.1 Canonical Terms (Top 10)
- <Term>: <1行定義>
- ...（なければ N/A）

### 5.2 Bounded Context / Ownership (Top-level)
- Context: <name> / Owner: <service/team> / Responsibility: <1行>
- ...（なければ N/A）

### 5.3 Invariants (If defined)
- INV-001: <rule>
- ...（なければ N/A）

---

## 6) Requirements Snapshot (Strict, excerpt)
> **抜粋でOK**。全文はrequirements.mdが正。
<!-- AUTO:BEGIN requirements_snapshot -->
### 6.1 Focus REQs (This phase)
| REQ | Title | Priority | Status |
|---|---|---|---|
| REQ-0001 | 開発環境構築手順 | MUST | Draft |
| REQ-0002 | タスクCRUD機能 | MUST | Draft |
| REQ-0003 | タスク親子関係管理 | MUST | Draft |
| REQ-0004 | タスクプール画面 | MUST | Draft |
| REQ-0006 | タスクキュー管理 | MUST | Draft |
| REQ-0007 | タスクキュー画面 | MUST | Draft |
| REQ-0005 | タスク検索・フィルタ機能 | SHOULD | Draft |

### 6.2 Acceptance Details (Only for focus REQs)
- **REQ-0001**
  - Given: クリーンな開発環境
  - When: 構築手順ドキュメントに従って環境構築を実行
  - Then: Tauri + Rust + SQLite + Reactの開発環境が利用可能になり、アプリケーションのビルド・実行が可能
- **REQ-0002**
  - Given: TBD
  - When: TBD
  - Then: TBD
- **REQ-0003**
  - Given: タスク作成・編集画面
  - When: ユーザーが親タスクを指定して子タスクを作成
  - Then: データベースに親子関係が保存され、UIで関係が視覚的に表示される
- **REQ-0004**
  - Given: アプリケーションが起動している
  - When: ユーザーがタスクプール画面を開く
  - Then: 全タスクとその親子関係がツリー構造で表示され、CRUD操作が可能
- **REQ-0006**
  - Given: タスクプール画面でタスクが選択されている
  - When: ユーザーが「キューに追加」操作を行う
  - Then: 選択されたタスクが日次キューに追加され、重複は許可されない
- **REQ-0007**
  - Given: アプリケーションが起動している
  - When: ユーザーがタスクキュー画面を開く
  - Then: 日次キューのタスクがリスト表示され、完了状態の更新が可能
- **REQ-0005**
  - Given: タスクプール画面にタスクが表示されている
  - When: ユーザーが検索キーワードを入力またはフィルタを選択
  - Then: 条件に一致するタスクのみが表示される
<!-- AUTO:END requirements_snapshot -->
---

## 7) Contract Snapshot (HTTP + Events) — may be empty
> **空でもOK**。Contractフェーズで埋める。

<!-- AUTO:BEGIN contract_snapshot -->
### 7.1 HTTP Operations (OpenAPI)
| operationId | Path/Method | x-requirements | Notes |
|---|---|---|---|
| <verbNoun e.g. createItem> | POST /<resource> | REQ-0003 | - |
| <verbNoun e.g. getItem> | GET /<resource>/{id} | REQ-0004 | - |
| <verbNoun e.g. listItems> | GET /<resource> | REQ-0001, REQ-0002 | - |

### 7.2 Event Notifications (AsyncAPI)
| messageId | Channel | x-requirements | Notes |
|---|---|---|---|
| <stableId e.g. auth.password_reset_completed.v1> | <topic-name> | REQ-0011 | - |
| <stableId e.g. auth.password_reset_requested.v1> | <topic-name> | REQ-0007, REQ-0008 | - |
<!-- AUTO:END contract_snapshot -->
---

## 8) Tasking: What you must produce now
> ここがAIへの指示書。曖昧な依頼は禁止。

<!-- AUTO:BEGIN tasking_snapshot -->
### 8.1 Current Phase Tasks (from tasks.md)
| TASK-ID | Title | Status | Priority | Maps to |
|---|---|---|---|---|
| TASK-0001 | <short title> | UnDone | P0 | REQ-0001 |
| TASK-0002 | ... | Processing | P1 | operationId: createItem |

### 8.2 Task Progress
- Total Tasks: 2
- Done: 0
- Processing: 1
- UnDone: 1
- Progress: 0% (0/2)

### 8.3 Next Actions
1. Start TASK-0001 (<short title>)
<!-- AUTO:END tasking_snapshot -->

---

### 8.4 Manual Instructions (Edit as needed)
> **このセクションは Phase に応じて自動生成**：必要に応じて編集可能

#### 8.4.1 Primary deliverable
- Deliverable type: glossary, domain
- Target file path: `20_domain/glossary.md`, `20_domain/domain.md`
- Required sections to modify:
  - (See work steps below)

#### 8.4.2 Work steps (Follow in order)
1. requirements.md から用語を抽出
2. glossary.md に Canonical terms を定義（1用語=1定義）
3. domain.md で Bounded Context を定義
4. Entity、Value Object、Aggregate を定義
5. ドメイン不変条件を明記

#### 8.4.3 Output format (Strict)
- Provide:
  1. **Proposed edits** (copy-pastable content)
  2. **Diff summary** (Added/Changed/Removed bullets)
  3. **Open questions** (if any; max 10, targeted)

#### 8.4.4 Constraints for this task
- Must keep operationId stable: N/A
- Must keep messageId stable: N/A
- Must not introduce new terms unless added to glossary first: Yes (this is the phase to create it)
- Must update traceability: No
---

## 9) Pre-flight Checks (Gate)
<!-- AUTO:BEGIN preflight_checks -->
### 9.1 Coverage Checks
- [x] All operationIds have x-requirements (3/3)
- [x] All messageIds have x-requirements (2/2)
- [x] Focus REQs defined (7 REQs)

### 9.2 Drift Checks
- [x] No unmapped operations
- [x] No unmapped messages
- [x] No undefined terms in requirements

### 9.3 Quality Metrics
- REQ Coverage: 7 REQs
- API Coverage: 3/3
- Event Coverage: 2/2
- Task Completion: 0% (0/2)

### 9.4 Overall Status
**✅ Ready for next phase**
<!-- AUTO:END preflight_checks -->

---

### 9.5 Manual Checks (Review before PR)
> **このセクションは手動確認**：レビュー時にチェック

- [ ] No new terms introduced without glossary update
- [ ] No implementation details leaked into requirements
- [ ] Canonical file paths preserved (no "v2 filename")
- [ ] All tests passing
- [ ] Code review completed

---

## 10) Notes / Context (Optional)
- <補足>（なければ N/A）
